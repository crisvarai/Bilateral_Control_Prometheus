#include <iostream>
#include <cmath>
#include <iomanip>

using namespace std;

//----------------- Declaración de variables para Vector de Gravedad -----------------------//

// Declaración de parámetros DH 
double q1 = ( -90 )*M_PI/180;
double q2 = ( -115 )*M_PI/180;
double q3 = ( 0 )*M_PI/180;
double q4 = ( 0 )*M_PI/180;
double q5 = ( 0 )*M_PI/180;
double q6 = ( 0 )*M_PI/180;

double d1 = 183.73/1000;     // dist. del pecho al hombro (q2)
double a2 = 58.28/1000;
double d3 = 244.4/1000;
double a3 = 18.76/1000;
double a4 = 18.53/1000;
double d5 = 123.03/1000;
double d7 = 150.0/1000;      // 150 mm is dist. from q6 to ee; 71 mm, from q7.

double k = 65*M_PI/180; // k equivale a alpha en DH

// Masas de los eslabones [kg]
double M1 = 1929.76/1000;
double M2 = 992.51/1000;
double M3 = 1126.28/1000;
double M4 = 540.00/1000;  
double M5 = 566.31/1000;
double M6 = (469.22)/1000;

// Posiciones P_i del centro de masa respecto al sistema de referencia i[m]
double x1 =   0.0546/1000, y_1 = 66.2941/1000, z1 = -0.9200/1000;
double x2 =  -5.0167/1000, y2 =  1.5300/1000, z2 = 61.1648/1000;
double x3 =  -0.2391/1000, y3 = 67.4386/1000, z3 = 41.4500/1000;
double x4 =  -0.4010/1000, y4 = -0.0100/1000, z4 = 56.9593/1000;
double x5 =  -0.2357/1000, y5 =  1.2364/1000, z5 = -0.3900/1000;
double x6 = -12.6485/1000, y6 = -6.0700/1000, z6 =  0.6260/1000;

// Aceleración de la gravedad [m/s^2]
double G = 9.81;

// Componetes del vector de gravedad
double g1, g2, g3, g4, g5, g6;

//------------------------------- INICIO DEL PROGRAMA PRINCIPAL -----------------------------//
int main() 
{
    //------------ Variables sigma para reducir la expresión del Vector de Gravedad ---------//
    double sig_29 = cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k);
    double sig_28 = cos(q3)*sig_29 + sin(k)*sin(q1)*sin(q3);
    double sig_27 = cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2);
    double sig_26 = cos(q4)*sig_28 + sin(q4)*sig_27;
    double sig_25 = sin(q3)*sig_29 - cos(q3)*sin(k)*sin(q1);
    double sig_24 = sin(q4)*sig_29 - cos(q3)*cos(q4)*sig_27;
    double sig_23 = sin(q4)*sig_28 - cos(q4)*sig_27;
    double sig_22 = sin(q5)*sig_25 - cos(q5)*sig_26;
    double sig_21 = sin(q5)*sig_28 + cos(q4)*cos(q5)*sig_25;
    double sig_20 = cos(q4)*sig_29 + cos(q3)*sin(q4)*sig_27;
    double sig_19 = cos(q5)*sig_24 + sin(q3)*sin(q5)*sig_27;
    double sig_18 = d5*sin(q4)*sig_25;
    double sig_17 = cos(q6)*sig_26 - cos(q5)*sin(q6)*sig_23;
    double sig_16 = cos(q5)*sig_28 - cos(q4)*sin(q5)*sig_25;
    double sig_15 = cos(q6)*sig_22 + sin(q6)*sig_23;
    double sig_14 = a4*cos(q3)*cos(q4)*sig_27;
    double sig_13 = a4*cos(q4)*sig_25;
    double sig_12 = a4*cos(q4)*sig_27;
    double sig_11 = a4*sin(q4)*sig_28;
    double sig_10 = a4*sin(q4)*sig_29;
    double sig_9  = a3*cos(q3)*sig_27;
    double sig_8  = a3*sin(q3)*sig_29; 
    double sig_7  = sin(q6)*sig_21 + cos(q6)*sin(q4)*sig_25;
    double sig_6  = sin(q5)*sig_24 - cos(q5)*sin(q3)*sig_27;
    double sig_5  = cos(q6)*sig_20 - sin(q6)*sig_19;
    double sig_4  = cos(q5)*sig_25 + sin(q5)*sig_26;
    double sig_3  = a3*cos(q3)*sin(k)*sin(q1);
    double sig_2  = a2*cos(k)*cos(q2);
    double sig_1  = a2*cos(q1)*sin(k)*sin(q2);

    // g1 = -G*(M1*x1*sin(k)*sin(q1) + M2*y2*cos(q1)*sin(k) + M1*z1*cos(q1)*sin(k) + a2*M2*cos(q2)*sin(k)*sin(q1) + a2*M3*cos(q2)*sin(k)*sin(q1) + a2*M4*cos(q2)*sin(k)*sin(q1) + a2*M5*cos(q2)*sin(k)*sin(q1) + a3*M3*cos(q1)*sin(k)*sin(q3) + a2*M6*cos(q2)*sin(k)*sin(q1) + a3*M4*cos(q1)*sin(k)*sin(q3) + a3*M5*cos(q1)*sin(k)*sin(q3) + a3*M6*cos(q1)*sin(k)*sin(q3) + M4*y4*cos(q1)*cos(q3)*sin(k) + M3*z3*cos(q1)*cos(q3)*sin(k) + d3*M3*sin(k)*sin(q1)*sin(q2) + d3*M4*sin(k)*sin(q1)*sin(q2) + d3*M5*sin(k)*sin(q1)*sin(q2) + d3*M6*sin(k)*sin(q1)*sin(q2) + M2*x2*cos(q2)*sin(k)*sin(q1) + M3*x3*cos(q1)*sin(k)*sin(q3) - M6*x6*cos(q4)*sin(k)*sin(q2) - M3*y3*sin(k)*sin(q1)*sin(q2) + M2*z2*sin(k)*sin(q1)*sin(q2) + 2*M6*x6*cos(q1)*cos(q1)*cos(q4)*sin(k)*sin(q2) + M6*x6*cos(k)*cos(q1)*cos(q2)*cos(q4) + a3*M3*cos(q2)*cos(q3)*sin(k)*sin(q1) + a3*M4*cos(q2)*cos(q3)*sin(k)*sin(q1) + a3*M5*cos(q2)*cos(q3)*sin(k)*sin(q1) + a3*M6*cos(q2)*cos(q3)*sin(k)*sin(q1) + a4*M4*cos(q1)*cos(q4)*sin(k)*sin(q3) + a4*M5*cos(q1)*cos(q4)*sin(k)*sin(q3) + a4*M6*cos(q1)*cos(q4)*sin(k)*sin(q3) + M6*y6*cos(q1)*cos(q3)*cos(q5)*sin(k) + M5*z5*cos(q1)*cos(q3)*cos(q5)*sin(k) + d5*M5*cos(q4)*sin(k)*sin(q1)*sin(q2) + d5*M5*cos(q1)*sin(k)*sin(q3)*sin(q4) + d5*M6*cos(q4)*sin(k)*sin(q1)*sin(q2) + d5*M6*cos(q1)*sin(k)*sin(q3)*sin(q4) + M3*x3*cos(q2)*cos(q3)*sin(k)*sin(q1) + M4*x4*cos(q1)*cos(q4)*sin(k)*sin(q3) + M5*x5*cos(q1)*cos(q3)*sin(k)*sin(q5) - M6*x6*cos(q2)*cos(q3)*sin(k)*sin(q4) - a4*M4*sin(k)*sin(q1)*sin(q2)*sin(q4) - a4*M5*sin(k)*sin(q1)*sin(q2)*sin(q4) - a4*M6*sin(k)*sin(q1)*sin(q2)*sin(q4) - M4*y4*cos(q2)*sin(k)*sin(q1)*sin(q3) - M5*y5*cos(q4)*sin(k)*sin(q1)*sin(q2) - M5*y5*cos(q1)*sin(k)*sin(q3)*sin(q4) - M3*z3*cos(q2)*sin(k)*sin(q1)*sin(q3) + M4*z4*cos(q4)*sin(k)*sin(q1)*sin(q2) + M4*z4*cos(q1)*sin(k)*sin(q3)*sin(q4) - M4*x4*sin(k)*sin(q1)*sin(q2)*sin(q4) + a4*M4*cos(q2)*cos(q3)*cos(q4)*sin(k)*sin(q1) + a4*M5*cos(q2)*cos(q3)*cos(q4)*sin(k)*sin(q1) + a4*M6*cos(q2)*cos(q3)*cos(q4)*sin(k)*sin(q1) + d5*M5*cos(q2)*cos(q3)*sin(k)*sin(q1)*sin(q4) + d5*M6*cos(q2)*cos(q3)*sin(k)*sin(q1)*sin(q4) + d7*M6*cos(q4)*cos(q6)*sin(k)*sin(q1)*sin(q2) + d7*M6*cos(q1)*cos(q6)*sin(k)*sin(q3)*sin(q4) + d7*M6*cos(q1)*cos(q3)*sin(k)*sin(q5)*sin(q6) + M4*x4*cos(q2)*cos(q3)*cos(q4)*sin(k)*sin(q1) - M6*x6*cos(k)*cos(q1)*cos(q3)*sin(q2)*sin(q4) + M5*x5*cos(q1)*cos(q4)*cos(q5)*sin(k)*sin(q3) + M6*x6*cos(q1)*cos(q3)*cos(q6)*sin(k)*sin(q5) - M5*y5*cos(q2)*cos(q3)*sin(k)*sin(q1)*sin(q4) - M6*y6*cos(q2)*cos(q5)*sin(k)*sin(q1)*sin(q3) - M6*y6*cos(q1)*cos(q4)*sin(k)*sin(q3)*sin(q5) + M4*z4*cos(q2)*cos(q3)*sin(k)*sin(q1)*sin(q4) - M5*z5*cos(q2)*cos(q5)*sin(k)*sin(q1)*sin(q3) - M5*z5*cos(q1)*cos(q4)*sin(k)*sin(q3)*sin(q5) + M6*z6*cos(q4)*cos(q6)*sin(k)*sin(q1)*sin(q2) + M6*z6*cos(q1)*cos(q6)*sin(k)*sin(q3)*sin(q4) + M6*z6*cos(q1)*cos(q3)*sin(k)*sin(q5)*sin(q6) - M5*x5*cos(q2)*sin(k)*sin(q1)*sin(q3)*sin(q5) - 2*M6*x6*cos(q1)*sin(k)*sin(q1)*sin(q3)*sin(q4) - M5*x5*cos(q5)*sin(k)*sin(q1)*sin(q2)*sin(q4) + M6*y6*sin(k)*sin(q1)*sin(q2)*sin(q4)*sin(q5) + M5*z5*sin(k)*sin(q1)*sin(q2)*sin(q4)*sin(q5) + 2*M6*x6*cos(q1)*cos(q1)*cos(q2)*cos(q3)*sin(k)*sin(q4) + d7*M6*cos(q2)*cos(q3)*cos(q6)*sin(k)*sin(q1)*sin(q4) + d7*M6*cos(q1)*cos(q4)*cos(q5)*sin(k)*sin(q3)*sin(q6) + M5*x5*cos(q2)*cos(q3)*cos(q4)*cos(q5)*sin(k)*sin(q1) + M6*x6*cos(q1)*cos(q4)*cos(q5)*cos(q6)*sin(k)*sin(q3) - M6*y6*cos(q2)*cos(q3)*cos(q4)*sin(k)*sin(q1)*sin(q5) - M5*z5*cos(q2)*cos(q3)*cos(q4)*sin(k)*sin(q1)*sin(q5) + M6*z6*cos(q2)*cos(q3)*cos(q6)*sin(k)*sin(q1)*sin(q4) + M6*z6*cos(q1)*cos(q4)*cos(q5)*sin(k)*sin(q3)*sin(q6) - d7*M6*cos(q2)*sin(k)*sin(q1)*sin(q3)*sin(q5)*sin(q6) - d7*M6*cos(q5)*sin(k)*sin(q1)*sin(q2)*sin(q4)*sin(q6) - M6*x6*cos(q2)*cos(q6)*sin(k)*sin(q1)*sin(q3)*sin(q5) - M6*x6*cos(q5)*cos(q6)*sin(k)*sin(q1)*sin(q2)*sin(q4) - M6*z6*cos(q2)*sin(k)*sin(q1)*sin(q3)*sin(q5)*sin(q6) - M6*z6*cos(q5)*sin(k)*sin(q1)*sin(q2)*sin(q4)*sin(q6) + d7*M6*cos(q2)*cos(q3)*cos(q4)*cos(q5)*sin(k)*sin(q1)*sin(q6) + M6*x6*cos(q2)*cos(q3)*cos(q4)*cos(q5)*cos(q6)*sin(k)*sin(q1) + M6*z6*cos(q2)*cos(q3)*cos(q4)*cos(q5)*sin(k)*sin(q1)*sin(q6));
    // g2 = -G*M4*(d3*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - x4*(sin(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + z4*(cos(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + cos(q3)*sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - y4*sin(q3)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)) + a2*cos(k)*cos(q2) + a3*cos(q3)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)) - a4*sin(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + a2*cos(q1)*sin(k)*sin(q2) + a4*cos(q3)*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - G*M3*(d3*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - y3*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + x3*cos(q3)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)) - z3*sin(q3)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)) + a2*cos(k)*cos(q2) + a3*cos(q3)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)) + a2*cos(q1)*sin(k)*sin(q2)) - G*M2*(x2*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)) + z2*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + a2*cos(k)*cos(q2) + a2*cos(q1)*sin(k)*sin(q2)) - G*M6*(d3*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + d5*(cos(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + cos(q3)*sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + y6*(sin(q5)*(sin(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - cos(q5)*sin(q3)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + d7*(cos(q6)*(cos(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + cos(q3)*sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - sin(q6)*(cos(q5)*(sin(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + sin(q3)*sin(q5)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - x6*(sin(q1)*(cos(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + cos(q3)*sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + cos(q6)*(cos(q5)*(sin(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + sin(q3)*sin(q5)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + z6*(cos(q6)*(cos(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + cos(q3)*sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - sin(q6)*(cos(q5)*(sin(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + sin(q3)*sin(q5)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + a2*cos(k)*cos(q2) + a3*cos(q3)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)) - a4*sin(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + a2*cos(q1)*sin(k)*sin(q2) + a4*cos(q3)*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - G*M5*(d3*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + d5*(cos(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + cos(q3)*sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - y5*(cos(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + cos(q3)*sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - x5*(cos(q5)*(sin(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + sin(q3)*sin(q5)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + z5*(sin(q5)*(sin(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - cos(q5)*sin(q3)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + a2*cos(k)*cos(q2) + a3*cos(q3)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)) - a4*sin(q4)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + a2*cos(q1)*sin(k)*sin(q2) + a4*cos(q3)*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)));
    // g3 =  G*M3*(x3*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + z3*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + a3*sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - a3*cos(q3)*sin(k)*sin(q1)) + G*M4*(y4*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + a4*cos(q4)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + x4*cos(q4)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + z4*sin(q4)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + a3*sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - a3*cos(q3)*sin(k)*sin(q1)) + G*M5*(x5*(sin(q5)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + cos(q4)*cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1))) + z5*(cos(q5)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1))) + a4*cos(q4)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + d5*sin(q4)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - y5*sin(q4)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + a3*sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - a3*cos(q3)*sin(k)*sin(q1)) + G*M6*(d7*(sin(q6)*(sin(q5)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + cos(q4)*cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1))) + cos(q6)*sin(q4)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1))) + x6*(cos(q6)*(sin(q5)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + cos(q4)*cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1))) - sin(q1)*sin(q4)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1))) + z6*(sin(q6)*(sin(q5)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + cos(q4)*cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1))) + cos(q6)*sin(q4)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1))) + y6*(cos(q5)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1))) + a4*cos(q4)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + d5*sin(q4)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + a3*sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - a3*cos(q3)*sin(k)*sin(q1));
    // g4 =  G*M4*(x4*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - z4*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + a4*sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - a4*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - G*M6*(d7*(cos(q6)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - cos(q5)*sin(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - x6*(sin(q1)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + cos(q5)*cos(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + z6*(cos(q6)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - cos(q5)*sin(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + d5*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - a4*sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + y6*sin(q5)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + a4*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - G*M5*(d5*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - y5*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) - a4*sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - x5*cos(q5)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + z5*sin(q5)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))) + a4*cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)));
    // g5 =  G*M5*(x5*(cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - z5*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2))))) + G*M6*(d7*sin(q6)*(cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - y6*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + x6*cos(q6)*(cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + z6*sin(q6)*(cos(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) + sin(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))));
    // g6 =  G*M6*(d7*(cos(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + sin(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + z6*(cos(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) + sin(q6)*(sin(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) - cos(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))) - x6*sin(q6)*(sin(q5)*(sin(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) - cos(q3)*sin(k)*sin(q1)) - cos(q5)*(cos(q4)*(cos(q3)*(cos(k)*sin(q2) - cos(q1)*cos(q2)*sin(k)) + sin(k)*sin(q1)*sin(q3)) + sin(q4)*(cos(k)*cos(q2) + cos(q1)*sin(k)*sin(q2)))));
    
    g1 = -G*(M1*x1*sin(k)*sin(q1) + M2*y2*cos(q1)*sin(k) + M1*z1*cos(q1)*sin(k) + a2*M2*cos(q2)*sin(k)*sin(q1) + a2*M3*cos(q2)*sin(k)*sin(q1) + a2*M4*cos(q2)*sin(k)*sin(q1) + a2*M5*cos(q2)*sin(k)*sin(q1) + a3*M3*cos(q1)*sin(k)*sin(q3) + a2*M6*cos(q2)*sin(k)*sin(q1) + a3*M4*cos(q1)*sin(k)*sin(q3) + a3*M5*cos(q1)*sin(k)*sin(q3) + a3*M6*cos(q1)*sin(k)*sin(q3) + M4*y4*cos(q1)*cos(q3)*sin(k) + M3*z3*cos(q1)*cos(q3)*sin(k) + d3*M3*sin(k)*sin(q1)*sin(q2) + d3*M4*sin(k)*sin(q1)*sin(q2) + d3*M5*sin(k)*sin(q1)*sin(q2) + d3*M6*sin(k)*sin(q1)*sin(q2) + M2*x2*cos(q2)*sin(k)*sin(q1) + M3*x3*cos(q1)*sin(k)*sin(q3) - M6*x6*cos(q4)*sin(k)*sin(q2) - M3*y3*sin(k)*sin(q1)*sin(q2) + M2*z2*sin(k)*sin(q1)*sin(q2) + 2*M6*x6*cos(q1)*cos(q1)*cos(q4)*sin(k)*sin(q2) + M6*x6*cos(k)*cos(q1)*cos(q2)*cos(q4) + a3*M3*cos(q2)*cos(q3)*sin(k)*sin(q1) + a3*M4*cos(q2)*cos(q3)*sin(k)*sin(q1) + a3*M5*cos(q2)*cos(q3)*sin(k)*sin(q1) + a3*M6*cos(q2)*cos(q3)*sin(k)*sin(q1) + a4*M4*cos(q1)*cos(q4)*sin(k)*sin(q3) + a4*M5*cos(q1)*cos(q4)*sin(k)*sin(q3) + a4*M6*cos(q1)*cos(q4)*sin(k)*sin(q3) + M6*y6*cos(q1)*cos(q3)*cos(q5)*sin(k) + M5*z5*cos(q1)*cos(q3)*cos(q5)*sin(k) + d5*M5*cos(q4)*sin(k)*sin(q1)*sin(q2) + d5*M5*cos(q1)*sin(k)*sin(q3)*sin(q4) + d5*M6*cos(q4)*sin(k)*sin(q1)*sin(q2) + d5*M6*cos(q1)*sin(k)*sin(q3)*sin(q4) + M3*x3*cos(q2)*cos(q3)*sin(k)*sin(q1) + M4*x4*cos(q1)*cos(q4)*sin(k)*sin(q3) + M5*x5*cos(q1)*cos(q3)*sin(k)*sin(q5) - M6*x6*cos(q2)*cos(q3)*sin(k)*sin(q4) - a4*M4*sin(k)*sin(q1)*sin(q2)*sin(q4) - a4*M5*sin(k)*sin(q1)*sin(q2)*sin(q4) - a4*M6*sin(k)*sin(q1)*sin(q2)*sin(q4) - M4*y4*cos(q2)*sin(k)*sin(q1)*sin(q3) - M5*y5*cos(q4)*sin(k)*sin(q1)*sin(q2) - M5*y5*cos(q1)*sin(k)*sin(q3)*sin(q4) - M3*z3*cos(q2)*sin(k)*sin(q1)*sin(q3) + M4*z4*cos(q4)*sin(k)*sin(q1)*sin(q2) + M4*z4*cos(q1)*sin(k)*sin(q3)*sin(q4) - M4*x4*sin(k)*sin(q1)*sin(q2)*sin(q4) + a4*M4*cos(q2)*cos(q3)*cos(q4)*sin(k)*sin(q1) + a4*M5*cos(q2)*cos(q3)*cos(q4)*sin(k)*sin(q1) + a4*M6*cos(q2)*cos(q3)*cos(q4)*sin(k)*sin(q1) + d5*M5*cos(q2)*cos(q3)*sin(k)*sin(q1)*sin(q4) + d5*M6*cos(q2)*cos(q3)*sin(k)*sin(q1)*sin(q4) + d7*M6*cos(q4)*cos(q6)*sin(k)*sin(q1)*sin(q2) + d7*M6*cos(q1)*cos(q6)*sin(k)*sin(q3)*sin(q4) + d7*M6*cos(q1)*cos(q3)*sin(k)*sin(q5)*sin(q6) + M4*x4*cos(q2)*cos(q3)*cos(q4)*sin(k)*sin(q1) - M6*x6*cos(k)*cos(q1)*cos(q3)*sin(q2)*sin(q4) + M5*x5*cos(q1)*cos(q4)*cos(q5)*sin(k)*sin(q3) + M6*x6*cos(q1)*cos(q3)*cos(q6)*sin(k)*sin(q5) - M5*y5*cos(q2)*cos(q3)*sin(k)*sin(q1)*sin(q4) - M6*y6*cos(q2)*cos(q5)*sin(k)*sin(q1)*sin(q3) - M6*y6*cos(q1)*cos(q4)*sin(k)*sin(q3)*sin(q5) + M4*z4*cos(q2)*cos(q3)*sin(k)*sin(q1)*sin(q4) - M5*z5*cos(q2)*cos(q5)*sin(k)*sin(q1)*sin(q3) - M5*z5*cos(q1)*cos(q4)*sin(k)*sin(q3)*sin(q5) + M6*z6*cos(q4)*cos(q6)*sin(k)*sin(q1)*sin(q2) + M6*z6*cos(q1)*cos(q6)*sin(k)*sin(q3)*sin(q4) + M6*z6*cos(q1)*cos(q3)*sin(k)*sin(q5)*sin(q6) - M5*x5*cos(q2)*sin(k)*sin(q1)*sin(q3)*sin(q5) - 2*M6*x6*cos(q1)*sin(k)*sin(q1)*sin(q3)*sin(q4) - M5*x5*cos(q5)*sin(k)*sin(q1)*sin(q2)*sin(q4) + M6*y6*sin(k)*sin(q1)*sin(q2)*sin(q4)*sin(q5) + M5*z5*sin(k)*sin(q1)*sin(q2)*sin(q4)*sin(q5) + 2*M6*x6*cos(q1)*cos(q1)*cos(q2)*cos(q3)*sin(k)*sin(q4) + d7*M6*cos(q2)*cos(q3)*cos(q6)*sin(k)*sin(q1)*sin(q4) + d7*M6*cos(q1)*cos(q4)*cos(q5)*sin(k)*sin(q3)*sin(q6) + M5*x5*cos(q2)*cos(q3)*cos(q4)*cos(q5)*sin(k)*sin(q1) + M6*x6*cos(q1)*cos(q4)*cos(q5)*cos(q6)*sin(k)*sin(q3) - M6*y6*cos(q2)*cos(q3)*cos(q4)*sin(k)*sin(q1)*sin(q5) - M5*z5*cos(q2)*cos(q3)*cos(q4)*sin(k)*sin(q1)*sin(q5) + M6*z6*cos(q2)*cos(q3)*cos(q6)*sin(k)*sin(q1)*sin(q4) + M6*z6*cos(q1)*cos(q4)*cos(q5)*sin(k)*sin(q3)*sin(q6) - d7*M6*cos(q2)*sin(k)*sin(q1)*sin(q3)*sin(q5)*sin(q6) - d7*M6*cos(q5)*sin(k)*sin(q1)*sin(q2)*sin(q4)*sin(q6) - M6*x6*cos(q2)*cos(q6)*sin(k)*sin(q1)*sin(q3)*sin(q5) - M6*x6*cos(q5)*cos(q6)*sin(k)*sin(q1)*sin(q2)*sin(q4) - M6*z6*cos(q2)*sin(k)*sin(q1)*sin(q3)*sin(q5)*sin(q6) - M6*z6*cos(q5)*sin(k)*sin(q1)*sin(q2)*sin(q4)*sin(q6) + d7*M6*cos(q2)*cos(q3)*cos(q4)*cos(q5)*sin(k)*sin(q1)*sin(q6) + M6*x6*cos(q2)*cos(q3)*cos(q4)*cos(q5)*cos(q6)*sin(k)*sin(q1) + M6*z6*cos(q2)*cos(q3)*cos(q4)*cos(q5)*sin(k)*sin(q1)*sin(q6));
    g2 = -G*M4*(d3*sig_29 - x4*sig_24 + z4*sig_20 - y4*sin(q3)*sig_27 + sig_2 + sig_9 - sig_10 + sig_1 + sig_14) - G*M3*(d3*sig_29 - y3*sig_29 + x3*cos(q3)*sig_27 - z3*sin(q3)*sig_27 + sig_2 + sig_9 + sig_1) - G*M2*(x2*sig_27 + z2*sig_29 + sig_2 + sig_1) - G*M6*(d3*sig_29 + d5*sig_20 + y6*sig_6 + d7*sig_5 - x6*(sin(q1)*sig_20 + cos(q6)*sig_19) + z6*sig_5 + sig_2 + sig_9 - sig_10 + sig_1 + sig_14) - G*M5*(d3*sig_29 + d5*sig_20 - y5*sig_20 - x5*sig_19 + z5*sig_6 + sig_2 + sig_9 - sig_10 + sig_1 + sig_14); 
    g3 = G*M3*(x3*sig_25 + z3*sig_28 + sig_8 - sig_3) + G*M4*(y4*sig_28 + sig_13 + x4*cos(q4)*sig_25 + z4*sin(q4)*sig_25 + sig_8 - sig_3) + G*M5*(x5*sig_21 + z5*sig_16 + sig_13 + sig_18 - y5*sin(q4)*sig_25 + sig_8 - sig_3) + G*M6*(d7*sig_7 + x6*(cos(q6)*sig_21 - sin(q1)*sin(q4)*sig_25) + z6*sig_7 + y6*sig_16 + sig_13 + sig_18 + sig_8 - sig_3);
    g4 = G*M4*(x4*sig_23 - z4*sig_26 + sig_11 - sig_12) - G*M6*(d7*sig_17 - x6*(sin(q1)*sig_26 + cos(q5)*cos(q6)*sig_23) + z6*sig_17 + d5*sig_26 - sig_11 + y6*sin(q5)*sig_23 + sig_12) - G*M5*(d5*sig_26 - y5*sig_26 - sig_11 - x5*cos(q5)*sig_23 + z5*sin(q5)*sig_23 + sig_12);
    g5 = G*M5*(x5*sig_4 - z5*sig_22) + G*M6*(d7*sin(q6)*sig_4 - y6*sig_22 + x6*cos(q6)*sig_4 + z6*sin(q6)*sig_4);
    g6 = G*M6*(d7*sig_15 + z6*sig_15 - x6*sin(q6)*sig_22);

    // cout << setprecision(4) << fixed << "g1: " << g1 << endl;
    // cout << setprecision(4) << fixed << "g2: " << g2 << endl;
    // cout << setprecision(4) << fixed << "g3: " << g3 << endl;
    // cout << setprecision(4) << fixed << "g4: " << g4 << endl;
    // cout << setprecision(4) << fixed << "g5: " << g5 << endl;
    // cout << setprecision(4) << fixed << "g6: " << g6 << endl;

    // double G[6] = {{g1}, {g2}, {g3}, {g4}, {g5}, {g6}};
    cout << "Vector de Gravedad: " << endl;
    double G[6] = {g1, g2, g3, g4, g5, g6};
    for(int i=0; i<6; i++) {
        cout << setw(8) << setprecision(4) << fixed << G[i] << "\n";
    } 
    cout << endl;

    return 0;
}


        